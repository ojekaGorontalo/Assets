<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>Rute - JeGo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <!-- CSS -->
  <link rel="stylesheet" href="css/rute.css">
</head>

<body>
  <!-- Input Panel -->
  <div class="panel">
    <div class="input-container">
      <input id="fromInput" type="text" placeholder="Mo jemput dimana?" />
      <button class="clear-btn" id="clearFromBtn">√ó</button>
      <button class="location-btn" id="locationFromBtn">‚åñ</button>
    </div>
    <div class="input-container">
      <input id="toInput" type="text" placeholder="Mo antar kamana?" />
      <button class="clear-btn" id="clearToBtn">√ó</button>
      <button class="location-btn" id="locationToBtn">‚åñ</button>
    </div>
    
    <!-- Panel Data Pengiriman Kurir -->
    <div class="delivery-info-panel" id="deliveryInfoPanel">
      <div class="delivery-item">
        <span class="delivery-label">Jenis Barang:</span>
        <span class="delivery-value" id="deliveryItemCategory">-</span>
      </div>
      <div class="delivery-item">
        <span class="delivery-label">Deskripsi:</span>
        <span class="delivery-value" id="deliveryDescription">-</span>
      </div>
      <div class="delivery-item">
        <span class="delivery-label">Pengirim:</span>
        <span class="delivery-value" id="deliverySender">-</span>
      </div>
      <div class="delivery-item">
        <span class="delivery-label">Penerima:</span>
        <span class="delivery-value" id="deliveryReceiver">-</span>
      </div>
    </div>
  </div>

  <!-- Penawaran Driver -->
  <div id="driverOffers" style="position: fixed; top: 10px; left: 50%; transform: translateX(-50%); width: 92%; max-width:420px; z-index: 99999; display:none;">
    <div style="background: rgba(255,255,255,0.98); border-radius:12px; box-shadow:0 6px 24px rgba(0,0,0,0.12); overflow:hidden;">
      <div style="padding:12px 16px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white;">
        <strong>üèÜ Penawaran Driver</strong>
        <button id="closeDriverOffers" style="background:none;border:none;font-weight:600;cursor:pointer;color:white;font-size:18px;">‚úï</button>
      </div>
      <div id="driverOfferList" style="max-height:60vh; overflow:auto; padding:12px;"></div>
    </div>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <!-- Controls -->
  <button id="mapModeBtn" class="map-mode-btn">Mode Malam</button>
  
  <!-- Route Details -->
  <div class="route-details" id="routeDetails">
    <div class="route-info">
      <div class="route-address">
        <span class="label">Penjemputan:</span>
        <span class="value" id="routeFrom">-</span>
      </div>
      <div class="route-address">
        <span class="label">Tujuan:</span>
        <span class="value" id="routeTo">-</span>
      </div>
    </div>
    <div class="route-stats">
      <div class="route-stat">
        <div class="stat-value" id="routeDuration">-</div>
        <div class="stat-label">Durasi</div>
      </div>
      <div class="route-stat">
        <div class="stat-value"><span class="price-highlight" id="routePrice">-</span></div>
        <div class="stat-label">Biaya</div>
      </div>
    </div>
  </div>

  <!-- Confirm Button -->
  <button class="confirm-btn" id="confirmBtn" disabled>Konfirmasi Rute</button>

  <!-- Cancel Button -->
  <button class="cancel-btn" id="cancelBtn" disabled>BATALKAN</button>

  <!-- Radar Loading -->
  <div class="radar" id="radar" style="display:none;">
    <span>Mencari driver...</span>
  </div>

  <!-- Popup Custom -->
  <div class="popup-overlay" id="popupOverlay">
    <div class="popup">
      <div class="popup-header">
        <h3 class="popup-title" id="popupTitle">Pemberitahuan</h3>
        <button class="popup-close" id="popupCloseBtn">√ó</button>
      </div>
      <div class="popup-content">
        <div class="popup-icon" id="popupIcon">‚ö†Ô∏è</div>
        <div class="popup-message" id="popupMessage">Pesan akan ditampilkan di sini</div>
        <div class="popup-buttons">
          <button class="popup-button popup-button-primary" id="popupButton">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup Penawaran Harga -->
  <div class="popup-overlay" id="priceOfferPopup">
    <div class="popup">
      <div class="popup-header">
        <h3 class="popup-title">üí° Naikkan Tarif</h3>
        <button class="popup-close" id="closePriceOfferBtn">√ó</button>
      </div>
      <div class="popup-content">
        <div class="popup-icon">üí∞</div>
        <div class="popup-message">
          <p>Belum ada driver yang menerima dalam 30 detik. Coba naikkan tarif untuk menarik perhatian driver.</p>
          <div style="margin: 15px 0; padding: 12px; background: #f8f9fa; border-radius: 8px;">
            <div style="font-size: 0.9rem; color: #666;">Tarif Saat Ini:</div>
            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);" id="currentPriceDisplay">Rp 0</div>
          </div>
        </div>
        <div class="popup-buttons" style="flex-direction: column; gap: 8px;">
          <button class="popup-button popup-button-primary" id="price10Btn">+ 10% (Rp <span id="price10">0</span>)</button>
          <button class="popup-button popup-button-primary" id="price20Btn">+ 20% (Rp <span id="price20">0</span>)</button>
          <button class="popup-button popup-button-warning" id="price30Btn">+ 30% (Rp <span id="price30">0</span>)</button>
          <button class="popup-button popup-button-secondary" id="continueWaitingBtn">Tidak, Terus Tunggu</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="js/rute.js"></script>
  
  <!-- Load Google Maps API -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCEsbn9W4ivUesB15wmDuMhOT4JR6Mq9Bs&callback=initMap&libraries=places,geometry&v=weekly"
    defer
  ></script>
</body>
</html>
