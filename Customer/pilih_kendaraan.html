<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pilih Kendaraan - JeGo</title>

<style>
body{margin:0;font-family:Arial;background:#f5f5f5}
header{background:#ff9800;color:#fff;padding:15px;text-align:center}
.container{padding:20px}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:15px;cursor:pointer;border:2px solid #eee}
.card:hover{border-color:#ff9800}
.btn{display:block;text-align:center;background:#ff9800;color:#fff;padding:12px;border-radius:8px;text-decoration:none}
.hidden{display:none}

/* LOADING */
.loading{
  position:fixed;
  inset:0;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  z-index:999;
}
.loading.hidden{
  display:none;
}
</style>
</head>

<body>

<div class="loading hidden" id="loading">Memproses...</div>

<header>
  <h2>Pilih Kendaraan</h2>
</header>

<div class="container hidden" id="loginRequired">
  <p>Silakan login terlebih dahulu</p>
  <a href="userLogin.html" class="btn">Login</a>
</div>

<div class="container hidden" id="mainContent">
  <div class="card" onclick="selectVehicle('motor')">ğŸ Motor</div>
  <div class="card" onclick="selectVehicle('bentor')">ğŸ›º Bentor</div>
  <div class="card" onclick="selectVehicle('mobil')">ğŸš— Mobil</div>
  <div class="card" onclick="selectVehicle('kurir_motor')">ğŸ“¦ Kurir Motor</div>
  <div class="card" onclick="selectVehicle('kurir_bentor')">ğŸ“¦ Kurir Bentor</div>
</div>

<script>
/* ===== ERUDA ===== */
(function(){
  var s=document.createElement('script');
  s.src='https://cdn.jsdelivr.net/npm/eruda';
  document.body.appendChild(s);
  s.onload=function(){eruda.init();};
})();

/* ===== SESSION ===== */
const LS_USER_KEY = 'jego_user_session';
const loading = document.getElementById('loading');
const mainContent = document.getElementById('mainContent');
const loginRequired = document.getElementById('loginRequired');

let userSession=null;
try{
  userSession = JSON.parse(localStorage.getItem(LS_USER_KEY));
}catch(e){}

if(!userSession || !userSession.uid){
  loginRequired.classList.remove('hidden');
}else{
  mainContent.classList.remove('hidden');
}

/* ===== DATA ===== */
const vehicleData={
  motor:{name:'Motor'},
  bentor:{name:'Bentor'},
  mobil:{name:'Mobil'},
  kurir_motor:{name:'Kurir Motor'},
  kurir_bentor:{name:'Kurir Bentor'}
};

function selectVehicle(type){
  loading.classList.remove('hidden');

  const selected={
    type:type,
    name:vehicleData[type].name,
    userId:userSession.uid,
    time:new Date().toISOString()
  };

  localStorage.setItem('jego_last_transport',JSON.stringify(selected));

  if(window.AppInventor){
    window.AppInventor.setWebViewString(JSON.stringify({
      action:'vehicle_selected',
      data:selected
    }));
  }

  setTimeout(()=>{
    location.href='rute.html';
  },500);
}
</script>

</body>
</html>
